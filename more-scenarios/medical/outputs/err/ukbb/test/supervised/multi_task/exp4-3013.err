[2024-07-01 22:19:39,676][    INFO] {'batch_size': 1,
 'control': 'ethn',
 'crop_size': 256,
 'data_desc': 'UKBB Test Data - Ethnicity Controlled -  108 Patients',
 'data_root': '/vol/aimspace/projects/ukbb/data/cardiac/cardiac_segmentations/subjects',
 'dataset': 'ukbb',
 'exp': '4',
 'method': 'supervised',
 'mode': 'test',
 'model': 'unimatch unet',
 'model_desc': 'Unimatch Unet 18 Pretrained on UKBB',
 'model_path': 'exp/ukbb/supervised/unet/exp4/seed42/multi_task/best.pth',
 'multi_task': True,
 'nclass': 4,
 'num_workers': 1,
 'pred_mask_path': 'outputs/results/imgs/ukbb/supervised/4/18/seed42',
 'results_path': 'outputs/results/csv/ukbb/supervised/unet/exp4/seed42/multi_task/ethn.csv',
 'seed': '42',
 'split': 18,
 'test_set': 108,
 'test_split_path': 'splits/ukbb/test/ethn.csv',
 'train_set': 182,
 'visualize': False}

Traceback (most recent call last):
  File "/vol/aimspace/users/khattab/UniMatch/more-scenarios/medical/inference.py", line 77, in <module>
    main()
  File "/vol/aimspace/users/khattab/UniMatch/more-scenarios/medical/inference.py", line 69, in main
    scores_df = eval_model(model, test_loader, cfg, logger, visualize=cfg['visualize'])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/aimspace/users/khattab/UniMatch/more-scenarios/medical/util/inference_utils.py", line 79, in eval_model
    for _, (img, mask, label, patient_id, frame, slice_idx) in enumerate(dataloader):
  File "/u/home/khattab/.conda/envs/unimatch/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/u/home/khattab/.conda/envs/unimatch/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/home/khattab/.conda/envs/unimatch/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/u/home/khattab/.conda/envs/unimatch/lib/python3.11/site-packages/torch/_utils.py", line 705, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/u/home/khattab/.conda/envs/unimatch/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/u/home/khattab/.conda/envs/unimatch/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/home/khattab/.conda/envs/unimatch/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/vol/aimspace/users/khattab/UniMatch/more-scenarios/medical/dataset/ukbb.py", line 47, in __getitem__
    return self.get_patient_images(self.patients_info[item])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/aimspace/users/khattab/UniMatch/more-scenarios/medical/dataset/ukbb.py", line 75, in get_patient_images
    slice_idx = int(patient_info['slice_idx'])
                    ~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'slice_idx'

